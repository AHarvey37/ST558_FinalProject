---
title: "EDA"
author: "Andrew Harvey"
format: html
editor: visual
---

## Introduction

This project will use the "diabetes_binary_health_indicators_BRFSS2015" dataset. According [Kaggle.com](https://www.kaggle.com/datasets/alexteboul/diabetes-health-indicators-dataset/data) this data set contains 253,680 observation where the response variable is whether the observed individual does not have diabetes (0) or has prediabetes/diabetes (1). While the dataset is in a numeric format the following vaiables are categorical:

1. Diabetes_binary (response variable)
2. HighBP
3. HighChol
4. CholCheck
5. Smoker
6. Stroke
7. HeartDiseaseorAttack
8. PhysActivity
9. Fruits
10. Veggies
11. HvyAlcoholConsump
12. AnyHealthcare
13. NoDocbcCost
14. DiffWalk
15. Sex

The following variables are continuous in the dataset:
1. BMI
2. GenHlth
3. MentHlth
4. PhysHlth
5. Age
6. Education
7. Income

# FIX ME
##describe the purpose of your EDA and ultimate goal of modeling

|    First we will load in the packages and the raw data.

```{r Libraries and Raw data, warning=FALSE, message=FALSE,}
library(tidyverse)
```

```{r Data exploration}
rawData <- read.csv("./diabetes_binary_health_indicators_BRFSS2015.csv")

# Quick determination of categorical variables
for (i in 1:length(rawData)) {
  print(unique(rawData[i]))
}
```

```{r Convert variables to factors}
#create a new data frame for cleaning and converts all binary variables into factors
Cleaning1<- rawData|>
  mutate(Diabetes_binary = as.factor(Diabetes_binary),
         HighBP = as.factor(HighBP),
         HighChol = as.factor(HighChol),
         CholCheck = as.factor(CholCheck),
         Smoker = as.factor(Smoker),
         Stroke = as.factor(Stroke),
         HeartDiseaseorAttack = as.factor(HeartDiseaseorAttack),
         PhysActivity = as.factor(PhysActivity),
         Fruits = as.factor(Fruits),
         Veggies = as.factor(Veggies),
         HvyAlcoholConsump = as.factor(HvyAlcoholConsump),
         AnyHealthcare = as.factor(AnyHealthcare),
         NoDocbcCost = as.factor(NoDocbcCost),
         DiffWalk = as.factor(DiffWalk),
         Sex = as.factor(Sex)
         )

```


```{r Summary Tables}
# frequency Body Mass Index (actual) by diabetes_binary
BMIsummary<- Cleaning1|>
  count(Diabetes_binary, BMI, name = "Count")

ggplot(BMIsummary,aes(x = BMI, y = Count)) + geom_bar(stat = "identity",position = "dodge", aes(fill = Diabetes_binary))+ facet_wrap(~Diabetes_binary) 

# General Health  
# 1 = excellent 2 = very good 3 = good 4 = fair 5 = poor
HealthSummary<-Cleaning1|>
  count(Diabetes_binary,GenHlth)

ggplot(HealthSummary, aes(GenHlth,n,colour = Diabetes_binary)) +
  geom_point(stat = "identity")+
  geom_smooth(aes(GenHlth,n),stat = "identity")

# Heavy Alcohol Consumpsion 
# Heavy drinkers (adult men having more than 14 drinks per week and adult women having more than 7 drinks per week)
HeartHealthSummary<- Cleaning1|>
  group_by(Diabetes_binary,HvyAlcoholConsump)|>
  tally()

ggplot(Cleaning1,aes(PhysHlth,fill = Diabetes_binary)) + geom_bar(position = "dodge")

# General Categories, Age, Education, Income
#
# Age: 1 = 18-24, 2 = 25-29, 3 = 30-34, 4 = 35-39, 5 = 40-44, 6 = 45-49, 7 = 50-54, 8 = 55-59, 9 = 60-64, 10 = 65-69, 11 = 70-74, 12 = 75-79, 13 = 80 or older
# 
# Education: 1: Did not graduate high school, 2: Graduated high school, 3: Attended college, 4: Graduated college
# 
# Income: 1: <$10K, 2: $10K–$15K, 3: $15K–$20K, 4: $20K–$25K, 5: $25K–$35K, 6: $35K–$50K, 7: $50K–$75K, 8: >$75K

GenBox <- Cleaning1|>
  group_by(Diabetes_binary)|>
  pivot_longer(col = c(Age,Education,Income),names_to = "Category", values_to = "level")|>
  count(Diabetes_binary,Category,level,name = "val")

ggplot(GenBox, aes(Diabetes_binary,level, fill = Diabetes_binary)) +
  geom_boxplot()+
  facet_wrap(~Category)+
  scale_y_continuous(breaks = c(1:13))+
  geom_text(aes(label=val))
  
  
```


```


[Click here for the Modeling Page](Modeling.html)